
-----CONSULTA DE TIPO DE TRAMITE----
 
select personal.NOMBRE_PERSONAL,personal.APELLIDO_PERSONAL,tramite.TIPO_TRAMITE,extract(year from tramite.ANIO_TRAMITE) 
from tramite 
INNER join personal on tramite.ID_PERSONAL = personal.ID_PERSONAL 
WHERE tramite.TIPO_TRAMITE='EXHUMACIONES';

select personal.NOMBRE_PERSONAL,personal.APELLIDO_PERSONAL,tramite.TIPO_TRAMITE,extract(year from tramite.ANIO_TRAMITE) from personal 
INNER join tramite on personal.ID_PERSONAL = tramite.ID_PERSONAL 
WHERE tramite.TIPO_TRAMITE='INHUMACION';

select extract(year from tramite.ANIO_TRAMITE) as a√±o, personal.NOMBRE_PERSONAL, personal.APELLIDO_PERSONAL,tramite.TIPO_TRAMITE, COUNT (TRAMITE.ID_TRAMITE) as CANTIDAS 
from TRAMITE 
INNER join PERSONAL on TRAMITE.ID_PERSONAL = PERSONAL.ID_PERSONAL 
WHERE tramite.TIPO_TRAMITE='INHUMACION'  OR tramite.TIPO_TRAMITE='EXHUMACIONES' 
group by extract(year from tramite.ANIO_TRAMITE), personal.NOMBRE_PERSONAL, personal.APELLIDO_PERSONAL, tramite.TIPO_TRAMITE;

DELETE FROM TRAMITE WHERE ID_TRAMITE=18;

----consulta de bovedas ocupadas----
select BOVEDA.NOMBRE_BOVEDA,BOVEDA.ESTADO_BOVEDA,FAM_PROPIETARIO.NOMBRE_FAM from BOVEDA
inner join FAM_PROPIETARIO on BOVEDA.ID_FAMPROPIETARIO=FAM_PROPIETARIO.ID_FAMPROPIETARIO
WHERE BOVEDA.ESTADO_BOVEDA='Ocupada' or BOVEDA.ESTADO_BOVEDA='OCUPADA' ;


--- CONSULTA CANTIDAD DE ESTRUCUTURA---
select estructura.TIPO_ESTRUCTURA,COUNT(estructura.ID_ESTRUCTURA) AS CANTIDAD_ESTRUCTURAS from estructura
WHERE estructura.TIPO_ESTRUCTURA='BOVEDA INDIVIDUAL' OR estructura.TIPO_ESTRUCTURA='NICHO' group by estructura.TIPO_ESTRUCTURA;
--CANTIDAD DE BOVEDAS QUE TIENE CADA PROPIETARIO---
select BOVEDA.ID_FAMPROPIETARIO,FAM_PROPIETARIO.NOMBRE_FAM, COUNT(BOVEDA.ID_FAMPROPIETARIO) AS CANTIDAD_BOVEDAS from BOVEDA 
inner join FAM_PROPIETARIO on BOVEDA.ID_FAMPROPIETARIO=FAM_PROPIETARIO.ID_FAMPROPIETARIO group by BOVEDA.ID_FAMPROPIETARIO, FAM_PROPIETARIO.NOMBRE_FAM;


-----consulta de reportes
SELECT extract(year from reporte.FECHA_REPORTE), reporte.ID_REPORTE,reporte.NOMBRE_REPORTE,reporte.DESCRIPCION_REPORTE from reporte;

---CONSULTA CANTIDAD DE REPORTEs por nombre---
select  reporte.NOMBRE_REPORTE, REPORTE.FECHA_REPORTE ,COUNT (REPORTE.ID_REPORTE) from REPORTE
WHERE reporte.NOMBRE_REPORTE='INVASION A LAS BOVEDAS'
OR reporte.NOMBRE_REPORTE='DETENCION DE ASALTATUMBAS'
group by reporte.NOMBRE_REPORTE, REPORTE.FECHA_REPORTE;

---CONSULTA CANTIDAD DE REPORTES POR FECHA--
select reporte.NOMBRE_REPORTE,  extract(year from FECHA_REPORTE) ,COUNT (REPORTE.ID_REPORTE) from REPORTE
WHERE extract(year from FECHA_REPORTE)= '2022' group by reporte.NOMBRE_REPORTE, extract(year from FECHA_REPORTE);